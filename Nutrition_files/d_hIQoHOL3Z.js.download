if (self.CavalryLogger) { CavalryLogger.start_js(["8LH124N"]); }

__d("MessengerWebGraphQLHelper",["errorCode","ActorURI","AsyncRequest","DTSG","DTSGParser","Deferred","FBLogger","WebGraphQLConfig","XGraphQLBatchAPIController","getAsyncParams","nullthrows"],(function(a,b,c,d,e,f,g,h){"use strict";var i="for (;;);",j=i.length;function a(a,b){return k([a],b)[0]}function k(a,b){var e={},f={};a=a.map(function(a,b){b="o"+b;e[b]={doc_id:c("nullthrows")(a.id),query_params:a.variables};a=new(c("Deferred"))();f[b]=a;return a.getPromise()});var g=babelHelpers["extends"]({},c("getAsyncParams")("POST"));b&&b.actorID!=null&&(g[d("ActorURI").PARAMETER_ACTOR]=b.actorID);var h=b&&b.batchName?{batch_name:b.batchName}:{};h=new(c("AsyncRequest"))().setURI(c("XGraphQLBatchAPIController").getURIBuilder().getURI()).setOption("suppressEvaluation",!0).setMethod("POST").setRequestHeader("Content-Type","application/x-www-form-urlencoded").setData(babelHelpers["extends"]({},h,g,{queries:JSON.stringify(e)})).setHandler(function(a){a=a.getPayload();a=a.response;try{if(a.startsWith(i)){var b=a.substring(j);b=JSON.parse(b);if(b.error==1357001){Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"Not logged in.",severity:"CRITICAL",should_end_session:!0}]})});return}}c("DTSGParser").updateFromAsyncResponse(a);b=a.split("\r\n");b.pop();b=b.map(function(a){return JSON.parse(a)});b.forEach(function(a){return Object.keys(a).forEach(function(b){var c=f[b];if(c){b=a[b];if(b.extensions){var e;e=(e=b.extensions)==null?void 0:e.dtsg_token;e&&d("DTSG").setToken(e)}b.errors?c.reject(b):b.data?c.resolve(b.data):c.reject({data:{},errors:[{message:"Unexpected response received from server.",severity:"CRITICAL",response:b}]})}})})}catch(b){c("FBLogger")("webgraphql").catching(b).mustfix("Bad response: ","%s%s",a.substr(0,250),a.length>250?"[truncated]":"")}Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"No response received from server.",severity:"CRITICAL"}]})})}).setTimeoutHandler(c("WebGraphQLConfig").timeout,function(){Object.keys(f).forEach(function(a){f[a].isSettled()||f[a].reject({data:{},errors:[{message:"Request timed out.",severity:"CRITICAL"}]})})}).setErrorHandler(function(a){var b=a.getErrorDescription();Object.keys(f).forEach(function(c){f[c].isSettled()||f[c].reject({data:{},errors:[{message:b,severity:"CRITICAL",error:a.getError()}]})})});b&&b.msgrRegion&&h.setRequestHeader("X-MSGR-Region",b.msgrRegion);h.setAllowCrossPageTransition(!0);h.send();return a}g.exec=a;g.execAll=k}),98);